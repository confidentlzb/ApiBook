##1. 接口简述

用户选择新银行卡或完成银行卡信息录入后，第三方机构调用还呗绑卡接口绑卡。


第三方机构不支持绑卡操作，需要还呗完成绑卡操作。
 用户在第三方机构可选择绑定已有的银行卡（第三方机构通过银行卡列表接口获取），也可选择绑定新的银行卡。 还呗需要通过手机验证码验证用户的真实性；查看说明：验证码绑卡接口说明。

##2. 调用场景
*卡鉴权通过后的协议支付确认

##3. 接口要求
* https接口
* 接口采用post方式
* 数据组织采用json传递
* 性能要求：2s，超过2s后判断为超时。超时后不会重试
* 幂等性要求：重复请求，还呗需返回相同结果。（由于可能出现网络超时，我们没有收到还呗返回的结果，我们会重试，若您返回非200，会导致用户无法完成后续操作）

##4. 接口定义
http://openapi.dev.lattebank.com/xxxchannel/bindCard?r_c=XXX(渠道代码大写)
###4.1 验证码绑卡接口说明
1. 用户进入绑卡页面，第三方机构调用还呗提供的银行卡列表接口，获取银行卡列表信息。
2. 根据用户的操作不同，后续流程不同
   * 用户选择已绑定的银行卡，此时无需发送验证码
      * 第三方机构调用还呗提供的绑卡接口，告知还呗用户选择的银行卡。还呗返回code=200后，我方则认为绑定成功。
   * 用户选择新绑定银行卡
      * 第三方机构调用还呗提供的绑卡接口，将用户填写的用户名、手机号、银行卡号、开户行、开户行地址、身份证号、回调地址等信息提交给还呗；
      * 还呗接收信息处理，并发送验证码给到用户，并告知处理结果（是否发送了验证码）。注：若还呗对接了银行卡列表接口，还呗只能对新绑卡发送验证码，已有银行卡无需发送验证码。若用户未收到验证码，支持用户操作重发验证码，将重新调用还呗绑卡接口；
      * 用户在第三方机构平台填写验证码，第三方机构调用还呗提供的接口发送验证码给到还呗；
      * 还呗接收验证码处理绑卡，并告知第三方机构数据是否接收成功；

####4.1.1 请求参数定义
参数|  名称|  值类型| 是否必填|  备注
----------- | ------------- | ------------
user_id| 第三方机构借款用户ID|  String|  Y|用户ID
bank_card| 绑卡卡号|  String|  Y| 绑卡卡号（完整卡号）
open_bank| 绑卡开户行| String|  Y| 绑定银行卡的开户行（例如：ICBC，ABC，CMB，CCB等）
user_name| 姓名|  String|  N| 用户姓名，新绑卡时有值，选择已有卡时可能为空
id_number| 身份证号|  String|  N| 用户身份证号，新绑卡时有值，选择已有旧卡时可能为空
user_mobile| 手机号| String|  N| 用户手机号，新绑卡时有值，选择已有旧卡时可能为空
bank_address|  开户行地址| String|  N| 开户行地址，新绑卡时有值，选择已有旧卡时可能为空
bank_card_type|  绑卡的卡类型|  Integer| N| 新绑卡时有值，选择已有旧卡时为空。 0：储蓄卡，1：信用卡
bind_card_src| 区分新旧卡| Integer| Y| 用于还呗区分新旧卡：1=绑定新卡, 2=确认旧卡
extra_info|  旧卡其他信息|  Object(JSON)|  N| 选择已有旧卡时，值为还呗在银行卡列表回传的值
contacts|  手机信息|  Object(JSON)|  N| 通讯录、设备等信息
verify_code| 验证码| String|  Y| 验证码

####4.1.2 请求示例
* 新绑卡时示例：
```
{
    "user_id": "246964109149933",
    "bank_card": "6222022005001212723",
    "open_bank": "ICBC",
    "user_name": "张三",
    "id_number": "110108198802019650",
    "user_mobile": "13420504517",
    "bank_address": "北京市 市辖区",
    "bank_card_type": 0,
    "bind_card_src": 1，
    "verify_code":"123456"
}
```
* 选择已有旧卡时示例：
```
{
    "user_id": "246964109149933",
    "bank_card": "6222022005001212723",
    "open_bank": "ICBC",
    "bind_card_src": 2,
}```

###4.2 响应说明
####4.2.1 参数定义

参数|   值类型 |是否必填|  备注
----------- | ------------- | ------------
code | Integer |Y| 200为绑定成功，其他为失败，其他情况：501该卡未通过审核 502该卡以被绑定 505 绑卡失败 801 验证码不正确 
message| String|  Y| 成功为success,失败为原因

####4.2.1 响应示例
```
{
    "code": 200,
    "message": "success"
}
```

